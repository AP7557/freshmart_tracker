(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2834:(e,t,a)=>{Promise.resolve().then(a.bind(a,3307))},3307:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var s=a(5155),l=a(7525),n=a(2115),r=a(4296),i=a(7976),o=a(6033),d=a(404),c=a(4263),m=a(4311),u=a(9776),x=a(7149),h=a(9959),p=a(9816),y=a(7348),f=a(3899),j=a(6673),g=a(3731);let v=e=>{let{setFilteredTransactions:t,sortedTransactions:a}=e,[l,r]=(0,n.useState)({company:"",type:"",dateFilterType:"equal",date:"",dateStart:"",dateEnd:""});(0,n.useEffect)(()=>{(()=>{let{company:e,type:s}=l;t(a.filter(t=>{let a=t.company.toLowerCase().includes(e.toLowerCase()),l=t.type.toLowerCase().includes(s.toLowerCase()),n=o(t);return a&&l&&n}))})()},[l,a]);let i=e=>new Date(e).toLocaleDateString("en-US",{timeZone:"UTC"}),o=e=>{let{dateFilterType:t,dateStart:a,dateEnd:s,date:n}=l;if("equal"===t&&n)return e.date===i(n);if("range"===t){if(a&&!s)return e.date>=i(a);if(!a&&s)return e.date<=i(s);if(a&&s){let t=e.date;return t>=i(a)&&t<=i(s)}}return!0},d=e=>{let{name:t,value:a}=e.target;r(e=>({...e,[t]:a}))};return(0,s.jsxs)(x.A,{sx:{display:"flex",flexDirection:"column",gap:2,paddingBottom:"2rem"},children:[(0,s.jsx)(x.A,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,s.jsxs)(p.A,{fullWidth:!0,size:"small",children:[(0,s.jsx)(y.A,{children:"Date Filter Type"}),(0,s.jsxs)(f.A,{value:l.dateFilterType,onChange:e=>r({...l,dateFilterType:e.target.value}),children:[(0,s.jsx)(j.A,{value:"equal",children:"Equal to"}),(0,s.jsx)(j.A,{value:"range",children:"Range"})]})]})}),(0,s.jsxs)(x.A,{sx:{display:"flex",gap:2},children:[(0,s.jsx)(g.A,{label:"Company",variant:"outlined",size:"small",value:l.company,onChange:e=>r({...l,company:e.target.value})}),(0,s.jsx)(g.A,{label:"Type",variant:"outlined",size:"small",value:l.type,onChange:e=>r({...l,type:e.target.value})})]}),"equal"===l.dateFilterType&&(0,s.jsx)(g.A,{label:"Date (m/d/yyyy)",variant:"outlined",size:"small",value:l.date,onChange:d,fullWidth:!0,name:"date",type:"date",slotProps:{inputLabel:{shrink:!0}}}),"range"===l.dateFilterType&&(0,s.jsxs)(x.A,{sx:{display:"flex",gap:2},children:[(0,s.jsx)(g.A,{label:"Start Date",variant:"outlined",size:"small",value:l.dateStart,onChange:d,fullWidth:!0,name:"dateStart",type:"date",slotProps:{inputLabel:{shrink:!0}}}),(0,s.jsx)(g.A,{label:"End Date",variant:"outlined",size:"small",value:l.dateEnd,onChange:d,fullWidth:!0,name:"dateEnd",type:"date",slotProps:{inputLabel:{shrink:!0}}})]})]})},b=e=>{let{allTransactionsForEachStore:t,storeSelected:a}=e,[l,p]=(0,n.useState)(0),[y,f]=(0,n.useState)("desc"),[j,g]=(0,n.useState)("date"),[b,A]=(0,n.useState)([]),[w,C]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=t.find(e=>e.store===a);C([...(e?e.transactions:[]).map((e,t)=>({...e,id:"".concat(a,"-").concat(t)}))].sort((e,t)=>{if("company"===j)return"asc"===y?e.company.localeCompare(t.company):t.company.localeCompare(e.company);if("amount"===j)return"asc"===y?e.amount-t.amount:t.amount-e.amount;if("date"===j){let a=new Date(e.date),s=new Date(t.date);return"asc"===y?a-s:s-a}return 0}))},[a,y,j]),(0,n.useEffect)(()=>{A(w)},[w]);let S=e=>{f(j===e&&"asc"===y?"desc":"asc"),g(e)};return(0,s.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Transactions"}),(0,s.jsxs)("ul",{className:"space-y-4",children:[(0,s.jsx)(v,{setFilteredTransactions:A,sortedTransactions:w}),(0,s.jsx)(r.A,{sx:{maxHeight:400,display:{xs:"none",sm:"block"}},children:(0,s.jsxs)(i.A,{stickyHeader:!0,children:[(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{children:(0,s.jsx)(m.A,{active:"company"===j,direction:"company"===j?y:"asc",onClick:()=>S("company"),children:"Company"})}),(0,s.jsx)(c.A,{children:(0,s.jsx)(m.A,{active:"amount"===j,direction:"amount"===j?y:"asc",onClick:()=>S("amount"),children:"Amount"})}),(0,s.jsx)(c.A,{children:"Type"}),(0,s.jsx)(c.A,{children:(0,s.jsx)(m.A,{active:"date"===j,direction:"date"===j?y:"asc",onClick:()=>S("date"),children:"Date"})})]})}),(0,s.jsx)(u.A,{children:b.slice(5*l,5*l+5).map(e=>(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{children:e.company}),(0,s.jsxs)(c.A,{children:["$",e.amount]}),(0,s.jsx)(c.A,{children:e.type}),(0,s.jsx)(c.A,{children:e.date})]},e.id))})]})}),(0,s.jsx)(x.A,{sx:{display:{xs:"block",sm:"none"}},children:b.slice(5*l,5*l+5).map(e=>(0,s.jsxs)(x.A,{sx:{border:"1px solid #ddd",borderRadius:2,padding:2,marginBottom:2,boxShadow:2},children:[(0,s.jsxs)(x.A,{sx:{fontWeight:"bold"},children:["Company: ",e.company]}),(0,s.jsxs)(x.A,{children:["Amount: $",e.amount]}),(0,s.jsxs)(x.A,{children:["Type: ",e.type]}),(0,s.jsxs)(x.A,{children:["Date: ",e.date]})]},e.id))}),(0,s.jsx)(h.A,{component:"div",rowsPerPageOptions:[5],count:b.length,rowsPerPage:5,page:l,onPageChange:(e,t)=>{p(t)}})]})]})};function A(e){let{storeSelected:t,totalInvoiceLeftToPay:a}=e;return(0,s.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Companies & Remaining Invoice"}),(0,s.jsx)("ul",{className:"space-y-4",children:(a[t]?Object.entries(a[t]).filter(e=>{let[t,a]=e;return Math.max(0,a.totalInvoice-a.totalPayment)>0}):[]).map(e=>{let[t,a]=e,l=Math.max(0,a.totalInvoice-a.totalPayment);return(0,s.jsxs)("li",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-lg font-semibold",children:t}),(0,s.jsxs)("span",{className:"text-lg font-bold text-red-600",children:["$",l.toFixed(2)]})]},t)})})]})}function w(){let[e,t]=(0,n.useState)(""),[a,r]=(0,n.useState)({}),{storesList:i,allTransactionsForEachStore:o}=(0,l.E)();(0,n.useEffect)(()=>{let e={};o.forEach(t=>{let{store:a,transactions:s}=t;s.forEach(t=>{let s=t.company,l=t.amount,n=t.type;e[a]||(e[a]={}),e[a][s]||(e[a][s]={totalPayment:0,totalInvoice:0}),"Payment"===n?e[a][s].totalPayment+=l:"Invoice"===n&&(e[a][s].totalInvoice+=l)})}),r(e)},[o]);let d=e=>a[e]?Object.values(a[e]).reduce((e,t)=>e+Math.max(0,t.totalInvoice-t.totalPayment),0):0;return(0,s.jsxs)("div",{className:"container !max-w-full mx-auto px-4 py-8",children:[(0,s.jsx)("h2",{className:"text-3xl font-semibold text-gray-700 mb-6",children:"Store Invoices Summary"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((e,a)=>(0,s.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 flex justify-between items-center cursor-pointer",onClick:()=>t(e),children:[(0,s.jsx)("div",{children:(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:e})}),(0,s.jsx)("div",{children:(0,s.jsxs)("span",{className:"text-lg font-bold text-red-600",children:["$",d(e).toFixed(2)]})})]},a))}),e&&(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8 mt-8",children:[(0,s.jsx)("div",{className:"order-1 lg:order-2 w-full",children:(0,s.jsx)(A,{storeSelected:e,totalInvoiceLeftToPay:a})}),(0,s.jsx)("div",{className:"order-2 lg:order-1 w-full",children:(0,s.jsx)(b,{allTransactionsForEachStore:o,storeSelected:e})})]})]})}},7525:(e,t,a)=>{"use strict";a.d(t,{M:()=>m,E:()=>c});var s=a(5155),l=a(2115),n=a(9670),r=a(5317);let i=async()=>{try{let e=(0,r.rJ)(n.db,"Lists");return(await (0,r.GG)(e)).docs.map(e=>e.data())}catch(e){return console.error("Error fetching lists: ",e),[]}},o=async e=>{try{let t=e.map(async e=>{let t=(await (0,r.GG)((0,r.rJ)(n.db,e))).docs.map(e=>e.data());return{store:e,transactions:t}});return await Promise.all(t)}catch(e){return console.error("Error fetching lists: ",e),[]}},d=(0,l.createContext)(),c=()=>(0,l.useContext)(d),m=e=>{let{children:t}=e,[a,n]=(0,l.useState)([]),[r,c]=(0,l.useState)([]),[m,u]=(0,l.useState)([]),[x,h]=(0,l.useState)([]);return(0,l.useEffect)(()=>{(async()=>{let[e,t]=await i("Lists"),a=Object.values(t);c(a),n(Object.values(e));let s=await o(a),l=new Date().toLocaleDateString("en-US"),r=x.map(e=>{let{store:t,transactions:a}=e;return a.filter(e=>e.date===l&&""!==e.date).map(e=>({...e,store:t}))}).flat();h(s),u(r)})()},[a,r]),(0,s.jsx)(d.Provider,{value:{companyList:a,storesList:r,todaysTransactionData:m,addTodaysTransaction:e=>{u(t=>[...t,e])},allTransactionsForEachStore:x},children:t})}},9670:(e,t,a)=>{"use strict";a.d(t,{db:()=>o,j:()=>i});var s=a(3915),l=a(6203),n=a(5317);let r=(0,s.Wp)({apiKey:"AIzaSyBrhGNzC2JEoYMR34bXv2vwMBQPVNl3NG8",authDomain:"freshmart-tracker.firebaseapp.com",projectId:"freshmart-tracker",storageBucket:"freshmart-tracker.firebasestorage.app",messagingSenderId:"36913606146",appId:"1:36913606146:web:5516b95ff654f02a9fc11b",measurementId:"G-MP5V2Y0VX2"}),i=(0,l.xI)(r),o=(0,n.aU)(r)}},e=>{var t=t=>e(e.s=t);e.O(0,[992,888,645,509,441,684,358],()=>t(2834)),_N_E=e.O()}]);