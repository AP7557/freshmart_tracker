(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[595],{278:(e,t,s)=>{"use strict";s.d(t,{r:()=>c});var r=s(5155),a=s(5695),n=s(2528),l=s(2115);function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(s){let c=(0,a.useRouter)(),{user:o,loading:i}=(0,n.A)();return((0,l.useEffect)(()=>{i||o||c.push("/login"),!i&&o&&t.length>0&&!t.includes(o.role)&&c.push("/addTransactions")},[o,i,c]),i||!o)?(0,r.jsx)("div",{children:"Loading..."}):t.length>0&&!t.includes(o.role)?(0,r.jsx)("div",{children:"Unauthorized"}):(0,r.jsx)(e,{...s,user:o})}}},1144:(e,t,s)=>{Promise.resolve().then(s.bind(s,8233))},2528:(e,t,s)=>{"use strict";s.d(t,{A:()=>u,O:()=>i});var r=s(5155),a=s(2115),n=s(9670),l=s(5317),c=s(6203);let o=(0,a.createContext)();function i(e){let{children:t}=e,[s,i]=(0,a.useState)(null),[u,d]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=(0,c.hg)(n.j,async e=>{if(!e){i(null),d(!1);return}try{let t=await (0,l.x7)((0,l.H9)(n.db,"users",e.uid));if(t.exists()){let s=t.data();i({uid:e.uid,email:e.email,...s})}}catch(e){console.error("Error fetching user data:",e)}finally{d(!1)}});return()=>e()},[s]),(0,r.jsx)(o.Provider,{value:{user:s,loading:u,setUser:i},children:t})}function u(){return(0,a.useContext)(o)}},7525:(e,t,s)=>{"use strict";s.d(t,{M:()=>d,E:()=>u});var r=s(5155),a=s(2115),n=s(9670),l=s(5317);let c=async()=>{try{let e=(0,l.rJ)(n.db,"Lists");return(await (0,l.GG)(e)).docs.map(e=>e.data())}catch(e){return console.error("Error fetching lists: ",e),[]}},o=async e=>{try{let t=e.map(async e=>{let t=(await (0,l.GG)((0,l.rJ)(n.db,e))).docs.map(e=>e.data());return{store:e,transactions:t}});return await Promise.all(t)}catch(e){return console.error("Error fetching transactions: ",e),[]}},i=(0,a.createContext)(),u=()=>(0,a.useContext)(i),d=e=>{let{children:t}=e,[s,n]=(0,a.useState)([]),[l,u]=(0,a.useState)([]),[d,m]=(0,a.useState)([]),[x,g]=(0,a.useState)([]);return(0,a.useEffect)(()=>{(async()=>{let[e,t]=await c("Lists"),s=Object.values(t);u(s),n(Object.values(e));let r=await o(s),a=new Date().toLocaleDateString("en-US"),l=x.map(e=>{let{store:t,transactions:s}=e;return s.filter(e=>e.date===a&&""!==e.date).map(e=>({...e,store:t}))}).flat();g(r),m(l)})()},[s,l]),(0,r.jsx)(i.Provider,{value:{companyList:s,storesList:l,todaysTransactionData:d,addTodaysTransaction:e=>{m(t=>[...t,e])},allTransactionsForEachStore:x},children:t})}},8233:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var r=s(5155),a=s(2115),n=s(2177),l=s(7525),c=s(9670),o=s(5317);let i=async(e,t)=>{try{await (0,o.gS)((0,o.rJ)(c.db,e),t)}catch(e){console.error("Error adding transaction: ",e)}},u=async(e,t)=>{try{await (0,o.BN)((0,o.H9)(c.db,"Lists",e),{[t]:t},{merge:!0})}catch(e){console.error("Error adding transaction: ",e)}};var d=s(351);function m(){let[e,t]=(0,a.useState)(""),s=async s=>{s.preventDefault(),e&&(u("Stores",e),t(""))};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[(0,r.jsx)(d.V5Y,{className:"text-green-600"}),"Register New Store"]}),(0,r.jsxs)("form",{onSubmit:s,className:"space-y-4",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter Store Name",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),(0,r.jsxs)("button",{type:"submit",className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200 flex items-center justify-center gap-2",children:[(0,r.jsx)(d.GGD,{}),"Register Store"]})]})]})}function x(e){let{storeSelected:t}=e,{todaysTransactionData:s}=(0,l.E)(),a=t?s.filter(e=>e.store===t):s;return t&&a.length>0&&(0,r.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[(0,r.jsx)(d.Wm,{className:"text-green-600"}),"Today's Transactions"]}),(0,r.jsx)("ul",{className:"space-y-3",children:a.map((e,t)=>(0,r.jsxs)("li",{className:"p-4 border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("div",{className:"font-medium text-gray-800",children:e.company}),(0,r.jsxs)("div",{className:"text-green-600 font-semibold",children:["$",e.amount.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-sm text-gray-600",children:[(0,r.jsx)(d.MRc,{className:"text-green-500",size:14}),(0,r.jsx)("span",{className:"capitalize px-2 py-1 rounded-full text-xs font-medium ".concat("Invoice"===e.type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:e.type.toLowerCase()})]})]},t))})]})}function g(e){let{isModalOpen:t,handleConfirmSubmit:s,setIsModalOpen:a}=e;return t&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-xl w-full max-w-md",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)(d.eHT,{className:"text-yellow-500",size:24}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Confirm Submission"})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to submit this transaction?"}),(0,r.jsxs)("p",{className:"text-red-500 mb-6 flex items-center gap-2",children:[(0,r.jsx)(d.eHT,{}),"You won't be able to edit/change once it's confirmed!"]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,r.jsxs)("button",{onClick:()=>a(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors duration-200 flex items-center gap-2",children:[(0,r.jsx)(d.yGN,{}),"Cancel"]}),(0,r.jsxs)("button",{onClick:s,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200 flex items-center gap-2",children:[(0,r.jsx)(d.YrT,{}),"Confirm"]})]})]})})}function f(){let[e,t]=(0,a.useState)(""),s=async s=>{s.preventDefault(),e&&(u("Companies",e),t(""))};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[(0,r.jsx)(d.qYx,{className:"text-green-600"}),"Register New Company"]}),(0,r.jsxs)("form",{onSubmit:s,className:"space-y-4",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter Company Name",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),(0,r.jsxs)("button",{type:"submit",className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200 flex items-center justify-center gap-2",children:[(0,r.jsx)(d.GGD,{}),"Register Company"]})]})]})}let p=function(e){var t;let{setStoreSelected:s,storeSelected:a,user:n}=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:" text-sm font-medium text-gray-700 flex items-center gap-2",children:[(0,r.jsx)(d.V5Y,{className:"text-green-600"}),"Store"]}),(0,r.jsxs)("select",{onChange:e=>s(e.target.value),value:a,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[(0,r.jsx)("option",{value:"",children:"Select a Store"}),null===(t=n.stores)||void 0===t?void 0:t.map((e,t)=>(0,r.jsx)("option",{value:e,children:e},t))]})]})};var h=s(9540),y=s(3731);let b=function(e){let{companySelected:t,setCompanySelected:s,register:n,errors:c}=e,{companyList:o}=(0,l.E)(),i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{i.current&&t&&(i.current.querySelector("input").value=t)},[t]),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center gap-2",children:[(0,r.jsx)(d.qYx,{className:"text-green-600"}),"Company"]}),(0,r.jsx)(h.A,{ref:i,options:o,value:t||null,onChange:(e,t)=>{s(t)},isOptionEqualToValue:(e,t)=>e===t,renderInput:e=>(0,r.jsx)(y.A,{...e,...n("company",{required:!0}),label:"Select a Company",variant:"outlined",className:"bg-white",fullWidth:!0})})]})};var j=s(278),N=s(9946);let v=(0,j.r)(function(e){let{user:t}=e,[s,c]=(0,a.useState)(""),[o,u]=(0,a.useState)(""),{register:h,handleSubmit:y,reset:j,watch:v,setValue:w,formState:{errors:S}}=(0,n.mN)(),[C,E]=(0,a.useState)(!1),[k,G]=(0,a.useState)(null),{addTodaysTransaction:T}=(0,l.E)(),A=v("check");(0,a.useEffect)(()=>{A&&""!==A?w("type","Payment"):w("type","")},[A]);let I=e=>{let t={...e,date:new Date().toLocaleDateString()};i(s,{...t}),T({...t,store:s}),u(""),j()},D=e=>{G(e),E(!0)};return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-4 md:p-6 max-w-4xl mx-auto",children:[(0,r.jsxs)("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center gap-2",children:[(0,r.jsx)(d.GGD,{className:"text-green-600"}),"Add Transaction"]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(p,{setStoreSelected:c,storeSelected:s,user:t}),s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b,{companySelected:o,setCompanySelected:u,register:h,errors:S}),!o&&(0,r.jsx)(f,{})]}),s&&o&&(0,r.jsxs)("form",{onSubmit:y(e=>D(e)),className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:" text-sm font-medium text-gray-700 flex items-center gap-2",children:[(0,r.jsx)(N.RpS,{className:"text-green-600"}),"Check Number"]}),(0,r.jsx)("input",{...h("check",{required:!1,valueAsNumber:!0}),type:"number",placeholder:"Enter Check Number",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[(0,r.jsx)(d.z8N,{className:"text-green-600"}),"Amount",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{...h("amount",{required:!0,valueAsNumber:!0}),type:"number",step:".01",placeholder:"Enter Amount",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),S.amount&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:"Amount is required."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:" text-sm font-medium text-gray-700 flex items-center gap-2",children:[(0,r.jsx)(d.MRc,{className:"text-green-600"}),"Type"]}),(0,r.jsxs)("select",{disabled:A&&""!==A||!1,...h("type",{required:!0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[(0,r.jsx)("option",{value:"",children:"Select a Type"}),(0,r.jsx)("option",{value:"Invoice",children:"Invoice"}),(0,r.jsx)("option",{value:"Payment",children:"Payment"})]})]}),(0,r.jsxs)("button",{type:"submit",className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200 flex items-center justify-center gap-2",children:[(0,r.jsx)(d.YrT,{}),"Save Transaction"]})]}),!s&&(0,r.jsx)(m,{}),(0,r.jsx)(x,{storeSelected:s})]}),(0,r.jsx)(g,{isModalOpen:C,handleConfirmSubmit:()=>{I(k),E(!1)},setIsModalOpen:E})]})})},9670:(e,t,s)=>{"use strict";s.d(t,{db:()=>o,j:()=>c});var r=s(3915),a=s(6203),n=s(5317);let l=(0,r.Wp)({apiKey:"AIzaSyBrhGNzC2JEoYMR34bXv2vwMBQPVNl3NG8",authDomain:"freshmart-tracker.firebaseapp.com",projectId:"freshmart-tracker",storageBucket:"freshmart-tracker.firebasestorage.app",messagingSenderId:"36913606146",appId:"1:36913606146:web:5516b95ff654f02a9fc11b",measurementId:"G-MP5V2Y0VX2"}),c=(0,a.xI)(l),o=(0,n.aU)(l)}},e=>{var t=t=>e(e.s=t);e.O(0,[992,158,844,613,866,47,628,441,684,358],()=>t(1144)),_N_E=e.O()}]);